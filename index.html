<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>我的歌單</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 20px;
      display: flex; 
      gap: 30px;
    }
    .left-panel { flex: 2; }
    .right-panel { 
      flex: 1; 
      border-left: 2px solid #ccc; 
      padding-left: 20px;
    }
    .tag { 
      display: inline-block; 
      background: #eee; 
      padding: 5px 10px; 
      margin: 2px; 
      border-radius: 5px; 
      cursor: pointer; 
    }
    .tag.active { 
      background: #007BFF; 
      color: white; 
    }
    #song-list li { 
      margin: 5px 0; 
      cursor: pointer; 
    }
    #song-list li:hover { 
      text-decoration: underline; 
    }
    #temp-list li { 
      margin: 5px 0; 
    }
    button { 
      margin-top: 10px; 
      padding: 5px 10px; 
      cursor: pointer; 
    }
    /* Toast 提示 */
    #toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 10px 15px;
      border-radius: 5px;
      display: none;
      z-index: 1000;
    }
  </style>
</head>
<body>

  <div class="left-panel">
    <h1>🎵 我的歌單</h1>
    <input type="text" id="search" placeholder="搜尋歌曲或歌手...">
    <div id="tag-container"></div>
    <ul id="song-list"></ul>
  </div>

  <div class="right-panel">
    <h2>暫存名單</h2>
    <ul id="temp-list"></ul>
    <button id="copy-btn">複製暫存名單</button>
  </div>

  <div id="toast"></div>

  <script>
    const songs = [
      { title: "Chitty Chitty Bang Bang", artist: "Lee Hyori", tags: ["Kpop", "Energetic", "Female Vocal"] },
      { title: "數到十", artist: "苦苦", tags: ["Mandopop", "Emotional", "Ballad"] },
      { title: "小幸運", artist: "田馥甄", tags: ["Mandopop", "Female Vocal", "Romantic"] },
      { title: "放屁歌", artist: "小瑜", tags: ["Mandopop", "Funny", "Female Vocal"] }
    ];

    const songList = document.getElementById("song-list");
    const searchInput = document.getElementById("search");
    const tagContainer = document.getElementById("tag-container");
    const tempList = document.getElementById("temp-list");
    const copyBtn = document.getElementById("copy-btn");
    const toast = document.getElementById("toast");

    let selectedTag = null;
    const tempSongs = new Set();

    const allTags = [...new Set(songs.flatMap(song => song.tags))];

    function showToast(message) {
      toast.textContent = message;
      toast.style.display = "block";
      setTimeout(() => { toast.style.display = "none"; }, 1500);
    }

    function renderTags() {
      tagContainer.innerHTML = "";
      allTags.forEach(tag => {
        const span = document.createElement("span");
        span.textContent = tag;
        span.classList.add("tag");
        span.addEventListener("click", () => {
          selectedTag = selectedTag === tag ? null : tag;
          renderTags();
          renderSongs();
        });
        if (selectedTag === tag) span.classList.add("active");
        tagContainer.appendChild(span);
      });
    }

    function renderSongs() {
      const searchText = searchInput.value.toLowerCase();
      songList.innerHTML = "";

      songs
        .filter(song =>
          (!selectedTag || song.tags.includes(selectedTag)) &&
          (song.title.toLowerCase().includes(searchText) || song.artist.toLowerCase().includes(searchText))
        )
        .forEach(song => {
          const li = document.createElement("li");
          li.textContent = `${song.title} - ${song.artist}`;
          li.addEventListener("click", () => {
            const songText = `${song.title} - ${song.artist}`;
            tempSongs.add(songText);
            renderTempList();
            navigator.clipboard.writeText(songText).then(() => {
              showToast(`已複製: ${songText}`);
            });
          });
          songList.appendChild(li);
        });
    }

    function renderTempList() {
      tempList.innerHTML = "";
      tempSongs.forEach(song => {
        const li = document.createElement("li");
        li.textContent = song;
        tempList.appendChild(li);
      });
    }

    copyBtn.addEventListener("click", () => {
      const text = Array.from(tempSongs).join("\n");
      navigator.clipboard.writeText(text).then(() => {
        showToast("已複製暫存名單！");
      });
    });

    searchInput.addEventListener("input", renderSongs);

    renderTags();
    renderSongs();
  </script>
</body>
</html>
